@page "/"
@model DeveloperPortal.Pages.DashboardModel

<div class="welcome-box">
    <h2 style="color:#135B79">Welcome to your Dashboard</h2>
    <span class="text-color">You are logged in as ananthalvan.soundararajan@@lacity.org</span>
</div>
<div class="dashboard-content">

    <h3 style="color:#135B79">My Projects</h3>

    <div style="width:100%;justify-content:space-between;display:flex">
        <div class="dashboard-summary-container">
            <span class="dashboard-summary-header text-color text-bold">
                New Projects Submitted
                <span style="float:right">(@Model.NewProjRecordCount)</span>
            </span>
            <div style="height:88.5%;overflow:auto;scroll-behavior:smooth;scrollbar-width:thin">
                <table id="tblNewProjects" class="display" style="width:100%">
                    <thead style="display:none">
                        <tr>
                            <th>Name</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
        <div class="dashboard-summary-container">
            <span class="dashboard-summary-header text-color text-bold">
                Plan Review
                <span style="float:right">(@Model.PlanReviewRecordCount)</span>
            </span>
            <div style="height:88.5%;overflow:auto;scroll-behavior:smooth;scrollbar-width:thin">
                <table id="tblPlanReview" class="display" style="width:100%">
                    <thead style="display:none">
                        <tr>
                            <th>Name</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
        <div class="dashboard-summary-container">
            <span class="dashboard-summary-header text-color text-bold">
                Site Inspection
                <span style="float:right">(@Model.SiteInspectionRecordCount)</span>
            </span>
            <div style="height:88.5%;overflow:auto;scroll-behavior:smooth;scrollbar-width:thin">
                <table id="tblSiteInspection" class="display" style="width:100%">
                    <thead style="display:none">
                        <tr>
                            <th>Name</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
        <div class="dashboard-summary-container">
            <span class="dashboard-summary-header text-color text-bold">
                NAC
                <span style="float:right">(@Model.NACRecordCount)</span>
            </span>
            <div style="height:88.5%;overflow:auto;scroll-behavior:smooth;scrollbar-width:thin">
                <table id="tblNACInspection" class="display" style="width:100%">
                    <thead style="display:none">
                        <tr>
                            <th>Name</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
        <div class="dashboard-summary-container">
            <span class="dashboard-summary-header text-color text-bold">
                Completed Certification
                <span style="float:right">(@Model.CompletedCertRecordCount)</span>
            </span>
            <div style="height:88.5%;overflow:auto;scroll-behavior:smooth;scrollbar-width:thin">
                <table id="tblCompletedCert" class="display" style="width:100%">
                    <thead style="display:none">
                        <tr>
                            <th>Name</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>
@{

}
@section Scripts{
    <script>
        $(document).ready(function () {
           /* $.ajax({
                "url": '/Dashboard/GetProjectData',
                "dataSrc": "",

                "success": function (data) {
                    console.log("GetProjectData");
                    console.log(data);
                }
            });*/

            PopulateData('tblNewProjects', 'NewProjects');
            PopulateData('tblPlanReview', 'PlanReview');
            PopulateData('tblSiteInspection', 'SiteInspection')
            PopulateData('tblNACInspection', 'NACInspection');
            PopulateData('tblCompletedCert', 'CompletedCert');
        });

        function PopulateData(tableName, dashboardCategory) {
            $('#' + tableName).DataTable({
                ajax: {
                    url: '/Dashboard/GetProjectData',
                    data: { name: dashboardCategory },
                    type: 'POST',
                    "headers": {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    dataType: 'json',
                    dataSrc: ''
                },
                sorting: false,
                searching: false,
                paging: false,
                info: false,
                header: false,
                columns: [
                    { data: 'projectName',
                        render: function (data, type, row, meta) { // render event defines the markup of the cell text
                            if (dashboardCategory == 'PlanReview') {
                                var a = '<a class="dashboard-anchor-plan-review" href="../planReview">' + row.projectName + '</a>';
                                return a;
                            }
                            else {
                                return data;
                            }
                        }
                    }
                ]
            });
        }
    </script>
}